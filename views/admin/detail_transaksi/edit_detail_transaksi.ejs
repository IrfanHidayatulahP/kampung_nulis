<%- include('../../partials/header.ejs') %>
    <div class="container mt-4">
        <h2>Edit Detail Transaksi #<%= detail.id_detail %>
        </h2>

        <% if (error) { %>
            <div class="alert alert-danger">
                <%= error %>
            </div>
            <% } %>

                <form method="post" action="/detail-transaksi/edit/<%= detail.id_detail %>">
                    <div class="mb-3">
                        <label class="form-label">ID Transaksi</label>
                        <% if (transaksiOptions && transaksiOptions.length) { %>
                            <select name="id_transaksi" class="form-control" required>
                                <% transaksiOptions.forEach(t=> { %>
                                    <option value="<%= t.id_transaksi %>" <%=t.id_transaksi===detail.id_transaksi
                                        ? 'selected' : '' %>><%= t.id_transaksi %> - <%= t.username || '' %>
                                    </option>
                                    <% }) %>
                            </select>
                            <% } else { %>
                                <input type="number" name="id_transaksi" class="form-control"
                                    value="<%= detail.id_transaksi %>" required>
                                <% } %>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Barang</label>
                        <% if (barangOptions && barangOptions.length) { %>
                            <select name="id_barang" class="form-control" required>
                                <% barangOptions.forEach(b=> { %>
                                    <option value="<%= b.id_barang %>" <%=b.id_barang===detail.id_barang ? 'selected'
                                        : '' %>><%= b.id_barang %> - <%= b.nama_barang %>
                                    </option>
                                    <% }) %>
                            </select>
                            <% } else { %>
                                <input type="number" name="id_barang" class="form-control"
                                    value="<%= detail.id_barang %>" required>
                                <% } %>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Jumlah Sewa</label>
                        <input type="number" name="jumlah_sewa" class="form-control" min="1"
                            value="<%= detail.jumlah_sewa %>" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Qty Kembali Bagus</label>
                        <input type="number" name="qty_kembali_bagus" class="form-control" min="0"
                            value="<%= detail.qty_kembali_bagus || 0 %>">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Harga Sewa per Satuan</label>
                        <input type="number" name="harga_sewa_per_satuan" class="form-control" min="0"
                            value="<%= detail.harga_sewa_per_satuan %>" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Total Harga Sewa (opsional)</label>
                        <input type="number" name="total_harga_sewa" class="form-control" min="0"
                            value="<%= detail.total_harga_sewa || '' %>">
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-success">Simpan</button>
                        <a href="/detail-transaksi/list-detail" class="btn btn-secondary">Batal</a>
                    </div>
                </form>
    </div>
    <%- include('../../partials/footer.ejs') %>